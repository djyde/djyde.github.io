<!DOCTYPE html><html data-saber-ssr><head><meta charset="UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta http-equiv="X-UA-Compatible" content="ie=edge" /><meta data-saber-head="ssr" name="generator" content="Saber v0.11.2"> <title>从 React 谈 Web UI 开发 - Randy&#x27;s Blog</title> <link data-saber-head="ssr" rel="stylesheet" href="//ppp.djyde.com/css?family=Noto+Serif+SC"><style data-vue-ssr-id="d798a246:0 5130aa06:0 a252aa48:0">/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}main{display:block}h1{font-size:2em;margin:.67em 0}hr{-webkit-box-sizing:content-box;box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:rgba(0,0,0,0)}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{-webkit-box-sizing:border-box;box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{-webkit-box-sizing:border-box;box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}[hidden],template{display:none}body{font-family:"Noto Serif SC",Lusitana,serif;line-height:1.4rem}blockquote{margin:0;padding:0 0 0 1.5rem;border-left:.5rem solid #ccc}a{color:#333;-webkit-transition:all .2s;transition:all .2s;text-decoration:none}a:hover{color:#000}a.big{padding-left:.25rem;padding-right:.25rem;border-bottom:.25rem solid #1a1a1a}a.big:hover{background-color:#000;color:#fff}.twitter{color:#0c9df2}.zhihu{color:#0767c8}.weibo{color:#e80025}.github{color:#333}.medium{color:#00ab6b}.email{color:#4285f4}.telegram{color:#179cde}.hr{height:0;font-size:1rem;line-height:0;text-transform:uppercase;text-align:center;border-bottom:1px solid #ccc;margin-top:2rem;margin-bottom:2rem;cursor:default;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.hr span{background-color:#fff;padding-left:.5em;padding-right:.5em;color:#ccc}li{margin-bottom:.5rem}h1,h2,h3,h4,h5,h6{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,PingFang SC,Hiragino Sans GB,Microsoft Yahei,sans-serif}#footer{margin-top:2em;padding:1em;background-color:#fafafa;text-align:center}#footer,#footer a{color:#c0c5ce}
code[class*=language-][data-v-48809fbe],pre[class*=language-][data-v-48809fbe]{color:#f8f8f2;background:none;text-shadow:0 1px rgba(0,0,0,.3);font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-][data-v-48809fbe]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}:not(pre)>code[class*=language-][data-v-48809fbe],pre[class*=language-][data-v-48809fbe]{background:#282a36}:not(pre)>code[class*=language-][data-v-48809fbe]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata[data-v-48809fbe],.token.comment[data-v-48809fbe],.token.doctype[data-v-48809fbe],.token.prolog[data-v-48809fbe]{color:#6272a4}.token.punctuation[data-v-48809fbe]{color:#f8f8f2}.namespace[data-v-48809fbe]{opacity:.7}.token.constant[data-v-48809fbe],.token.deleted[data-v-48809fbe],.token.property[data-v-48809fbe],.token.symbol[data-v-48809fbe],.token.tag[data-v-48809fbe]{color:#ff79c6}.token.boolean[data-v-48809fbe],.token.number[data-v-48809fbe]{color:#bd93f9}.token.attr-name[data-v-48809fbe],.token.builtin[data-v-48809fbe],.token.char[data-v-48809fbe],.token.inserted[data-v-48809fbe],.token.selector[data-v-48809fbe],.token.string[data-v-48809fbe]{color:#50fa7b}.language-css .token.string[data-v-48809fbe],.style .token.string[data-v-48809fbe],.token.entity[data-v-48809fbe],.token.operator[data-v-48809fbe],.token.url[data-v-48809fbe],.token.variable[data-v-48809fbe]{color:#f8f8f2}.token.atrule[data-v-48809fbe],.token.attr-value[data-v-48809fbe],.token.class-name[data-v-48809fbe],.token.function[data-v-48809fbe]{color:#f1fa8c}.token.keyword[data-v-48809fbe]{color:#8be9fd}.token.important[data-v-48809fbe],.token.regex[data-v-48809fbe]{color:#ffb86c}.token.bold[data-v-48809fbe],.token.important[data-v-48809fbe]{font-weight:700}.token.italic[data-v-48809fbe]{font-style:italic}.token.entity[data-v-48809fbe]{cursor:help}.saber-highlight code[data-v-48809fbe]{font-size:.5rem}.post-footer[data-v-48809fbe]{padding-top:2rem;text-align:center;color:#65737e}.post-footer p[data-v-48809fbe]{margin-top:.5em;margin-bottom:.5em}.bmc[data-v-48809fbe]{max-width:30%!important}@media (min-width:320px) and (max-width:479px){.bmc[data-v-48809fbe]{max-width:100%!important}}.cover[data-v-48809fbe]{padding-bottom:40%}@media (min-width:320px) and (max-width:479px){.cover[data-v-48809fbe]{padding-bottom:75%}}.cover[data-v-48809fbe]{background-size:cover;background-position:50%}.post[data-v-48809fbe]{margin-top:4rem}.post h1[data-v-48809fbe],.post h2[data-v-48809fbe],.post h3[data-v-48809fbe],.post h4[data-v-48809fbe],.post h5[data-v-48809fbe],.post h6[data-v-48809fbe]{margin:2rem 0 0}.post strong[data-v-48809fbe]{background-color:#e6e6e6;color:#000;padding-left:.25rem;padding-right:.25rem}.post .title[data-v-48809fbe]{line-height:2.5rem;margin-bottom:1rem}.post .date[data-v-48809fbe]{color:grey}@media (min-width:1025px){.post[data-v-48809fbe]{width:960px;margin:0 auto}}@media (min-width:320px) and (max-width:479px){.post[data-v-48809fbe]{padding-left:5%;padding-right:5%}.post img[data-v-48809fbe]{width:100%}}@media (min-width:481px) and (max-width:1024px){.post[data-v-48809fbe]{padding-left:5%;padding-right:5%}}.post .content img[data-v-48809fbe]{max-width:100%;display:block;margin:0 auto}@media (min-width:481px) and (max-width:1024px){.post .content img[data-v-48809fbe]{width:100%}}@media (min-width:320px) and (max-width:479px){.post .content img[data-v-48809fbe]{width:100%}}.post .content p[data-v-48809fbe]{line-height:1.8rem}.post .content a[data-v-48809fbe]{padding-left:.25rem;padding-right:.25rem;border-bottom:.25rem solid #1a1a1a}.post .content a[data-v-48809fbe]:hover{background-color:#000;color:#fff}.footer[data-v-48809fbe]{text-align:center}
nav[data-v-634644b4]{background-color:#000}nav .logo[data-v-634644b4]{padding-left:1rem;margin-right:2rem;display:inline-block}nav .logo a[data-v-634644b4]{font-weight:700;color:#fff}nav .nav-item[data-v-634644b4]{display:inline-block}nav .nav-item a[data-v-634644b4]{display:block;color:#fff;padding:.5rem}nav .nav-item a[data-v-634644b4]:hover{color:#000;background-color:#fff}</style>  </head><body><div id="_saber" data-server-rendered="true"><div><div data-v-48809fbe><nav data-v-634644b4 data-v-48809fbe><div class="logo" data-v-634644b4><a href="/" class="router-link-active" data-v-634644b4>Randy's Blog</a></div> <div class="nav-item" data-v-634644b4><a href="/readings" data-v-634644b4>Readings</a></div></nav> <!----> <div class="post" data-v-48809fbe><h1 class="title" data-v-48809fbe>从 React 谈 Web UI 开发</h1> <div class="date" data-v-48809fbe>January 01, 2017</div> <div class="content" data-v-48809fbe><blockquote data-lang="en" class="twitter-tweet" data-v-48809fbe><p lang="en" dir="ltr" data-v-48809fbe>If using React makes u confused, it's time to think about what React actually is. It's a great DOM diff algorithm with component system.</p>— Randy (@randyloop) <a rel="noopener noreferrer" target="_blank" href="https://twitter.com/randyloop/status/814663047541231616" data-v-48809fbe>December 30, 2016</a></blockquote> <script async="async" src="//platform.twitter.com/widgets.js" charset="utf-8" data-v-48809fbe></script> <p data-v-48809fbe>此前我在 Twitter 上这样表达过对 React 的理解，但是 Twitter 篇幅有限，所以在这篇文章里，我要做更详尽的阐述。</p> <p data-v-48809fbe>我从前不喜欢 React, 是因为写 React 的 render function 不像写 template 一样方便，尤其是存在复杂的判断渲染的时候，Vue 的 template 一个 v-if 就搞定了。而在 React 里写，需要把这个判断写成 function, 然后条件判断 return 哪一个 view. 这是我最初对 React 的偏见所在之一。</p> <p data-v-48809fbe>然而经过自己的实践和思考，加上阅读一些文章，我发现以前的想法是错的。我在使用 React 的时候，没有做到 Thinking in React. 从而对 React 产生了不解和困惑。</p> <p data-v-48809fbe>有很多人把 React 当成框架来用，这是用不好 React 的根本原因。很少人认真思考 <strong data-v-48809fbe>A JavaScript library for building User Interface</strong> 背后的含义，把 React 用得一团糟。</p> <p data-v-48809fbe>何谓 For Building User Interface? 意思就是，这个库仅仅是用于构建 UI 的，这是 React 本质要解决的问题。我甚至和很多人说，事实上 React 本身是不是 React 已经不重要了，重要的是我们写 UI 的思维。<strong data-v-48809fbe>React 这个 library 本身仅仅是用来实现这个思维的手段</strong>。React 提供的，是优秀的 DOM diff 算法，和一套 Component system。换成代码来说，也就是：</p> <div class="saber-highlight" data-lang="javascript" data-v-48809fbe><pre class="saber-highlight-code language-javascript" data-v-48809fbe><code class="language-javascript" data-v-48809fbe><span class="token punctuation" data-v-48809fbe>(</span><span class="token parameter" data-v-48809fbe>state</span><span class="token punctuation" data-v-48809fbe>)</span> <span class="token operator" data-v-48809fbe>=&gt;</span> View</code></pre></div><p data-v-48809fbe>这是 React building UI 的核心思想，所有的组件，就是接受 state, 返回一个 View. 这样看上去比较抽象，比如我们有一个 Clock 组件：</p> <div class="saber-highlight" data-lang="javascript" data-v-48809fbe><pre class="saber-highlight-code language-javascript" data-v-48809fbe><code class="language-javascript" data-v-48809fbe><span class="token keyword" data-v-48809fbe>const</span> <span class="token function-variable function" data-v-48809fbe>Clock</span> <span class="token operator" data-v-48809fbe>=</span> <span class="token punctuation" data-v-48809fbe>(</span><span class="token parameter" data-v-48809fbe>time</span><span class="token punctuation" data-v-48809fbe>)</span> <span class="token operator" data-v-48809fbe>=&gt;</span> <span class="token template-string" data-v-48809fbe><span class="token template-punctuation string" data-v-48809fbe>`</span><span class="token string" data-v-48809fbe>
&lt;div id='clock'&gt;
	&lt;span&gt;It's now: &lt;/span&gt;
	&lt;span&gt;</span><span class="token interpolation" data-v-48809fbe><span class="token interpolation-punctuation punctuation" data-v-48809fbe>${</span>time<span class="token interpolation-punctuation punctuation" data-v-48809fbe>}</span></span><span class="token string" data-v-48809fbe>&lt;/span&gt;
&lt;/div&gt;
</span><span class="token template-punctuation string" data-v-48809fbe>`</span></span></code></pre></div><p data-v-48809fbe>Clock 是一个 function, 接受一个 time 参数，返回的是一串 HTML String. 在程序里，我们可以给一个 Interval, 每秒传一个当前的 time, 得到一个新的 HTML String, 然后 apply 到某个 DOM 上。</p> <div class="saber-highlight" data-lang="javascript" data-v-48809fbe><pre class="saber-highlight-code language-javascript" data-v-48809fbe><code class="language-javascript" data-v-48809fbe><span class="token keyword" data-v-48809fbe>const</span> $app <span class="token operator" data-v-48809fbe>=</span> document<span class="token punctuation" data-v-48809fbe>.</span><span class="token function" data-v-48809fbe>getElementById</span><span class="token punctuation" data-v-48809fbe>(</span><span class="token string" data-v-48809fbe>'app'</span><span class="token punctuation" data-v-48809fbe>)</span>

<span class="token function" data-v-48809fbe>setInterval</span><span class="token punctuation" data-v-48809fbe>(</span><span class="token punctuation" data-v-48809fbe>(</span><span class="token punctuation" data-v-48809fbe>)</span> <span class="token operator" data-v-48809fbe>=&gt;</span> <span class="token punctuation" data-v-48809fbe>{</span>
  $app<span class="token punctuation" data-v-48809fbe>.</span>innerHTMl <span class="token operator" data-v-48809fbe>=</span> <span class="token function" data-v-48809fbe>Clock</span><span class="token punctuation" data-v-48809fbe>(</span>Date<span class="token punctuation" data-v-48809fbe>.</span><span class="token function" data-v-48809fbe>now</span><span class="token punctuation" data-v-48809fbe>(</span><span class="token punctuation" data-v-48809fbe>)</span><span class="token punctuation" data-v-48809fbe>)</span>
<span class="token punctuation" data-v-48809fbe>}</span><span class="token punctuation" data-v-48809fbe>,</span> <span class="token number" data-v-48809fbe>1000</span><span class="token punctuation" data-v-48809fbe>)</span></code></pre></div><p data-v-48809fbe>这样的实现是能达到目的的，但是问题在于，每次 <code data-v-48809fbe>innerHTML</code> 时，整个 <code data-v-48809fbe>#app</code> 的 DOM 树会被重新渲染。</p> <p data-v-48809fbe><img src="https://gbstatic.djyde.com/blog/plain-render-clock.gif" alt="" data-v-48809fbe></p> <p data-v-48809fbe>我们都知道，DOM 更新的花费是昂贵的。整个 DOM 树，实际上只是一个 <code data-v-48809fbe>span</code> 在不断变化，所以我们需要 DOM diff 算法来得知到底哪一个 DOM 节点才需要被更新，从而节省开销：</p> <div class="saber-highlight" data-lang="javascript" data-v-48809fbe><pre class="saber-highlight-code language-javascript" data-v-48809fbe><code class="language-javascript" data-v-48809fbe><span class="token keyword" data-v-48809fbe>const</span> <span class="token function-variable function" data-v-48809fbe>Clock</span> <span class="token operator" data-v-48809fbe>=</span> <span class="token punctuation" data-v-48809fbe>(</span><span class="token parameter" data-v-48809fbe><span class="token punctuation" data-v-48809fbe>{</span>time<span class="token punctuation" data-v-48809fbe>}</span></span><span class="token punctuation" data-v-48809fbe>)</span> <span class="token operator" data-v-48809fbe>=&gt;</span> <span class="token punctuation" data-v-48809fbe>(</span>
  <span class="token operator" data-v-48809fbe>&lt;</span>div id<span class="token operator" data-v-48809fbe>=</span><span class="token string" data-v-48809fbe>'clock'</span><span class="token operator" data-v-48809fbe>&gt;</span>
    <span class="token operator" data-v-48809fbe>&lt;</span>span<span class="token operator" data-v-48809fbe>&gt;</span>It's now<span class="token punctuation" data-v-48809fbe>:</span> <span class="token operator" data-v-48809fbe>&lt;</span><span class="token operator" data-v-48809fbe>/</span>span<span class="token operator" data-v-48809fbe>&gt;</span>
    <span class="token operator" data-v-48809fbe>&lt;</span>span<span class="token operator" data-v-48809fbe>&gt;</span><span class="token punctuation" data-v-48809fbe>{</span>time<span class="token punctuation" data-v-48809fbe>}</span><span class="token operator" data-v-48809fbe>&lt;</span><span class="token operator" data-v-48809fbe>/</span>span<span class="token operator" data-v-48809fbe>&gt;</span>
  <span class="token operator" data-v-48809fbe>&lt;</span><span class="token operator" data-v-48809fbe>/</span>div<span class="token operator" data-v-48809fbe>&gt;</span>
<span class="token punctuation" data-v-48809fbe>)</span>

<span class="token keyword" data-v-48809fbe>const</span> $app <span class="token operator" data-v-48809fbe>=</span> document<span class="token punctuation" data-v-48809fbe>.</span><span class="token function" data-v-48809fbe>getElementById</span><span class="token punctuation" data-v-48809fbe>(</span><span class="token string" data-v-48809fbe>'app'</span><span class="token punctuation" data-v-48809fbe>)</span>

<span class="token function" data-v-48809fbe>setInterval</span><span class="token punctuation" data-v-48809fbe>(</span><span class="token punctuation" data-v-48809fbe>(</span><span class="token punctuation" data-v-48809fbe>)</span> <span class="token operator" data-v-48809fbe>=&gt;</span> <span class="token punctuation" data-v-48809fbe>{</span>
  ReactDOM<span class="token punctuation" data-v-48809fbe>.</span><span class="token function" data-v-48809fbe>render</span><span class="token punctuation" data-v-48809fbe>(</span><span class="token operator" data-v-48809fbe>&lt;</span>Clock time<span class="token operator" data-v-48809fbe>=</span><span class="token punctuation" data-v-48809fbe>{</span>Date<span class="token punctuation" data-v-48809fbe>.</span><span class="token function" data-v-48809fbe>now</span><span class="token punctuation" data-v-48809fbe>(</span><span class="token punctuation" data-v-48809fbe>)</span><span class="token punctuation" data-v-48809fbe>}</span> <span class="token operator" data-v-48809fbe>/</span><span class="token operator" data-v-48809fbe>&gt;</span><span class="token punctuation" data-v-48809fbe>,</span> $app<span class="token punctuation" data-v-48809fbe>)</span>
<span class="token punctuation" data-v-48809fbe>}</span><span class="token punctuation" data-v-48809fbe>,</span> <span class="token number" data-v-48809fbe>1000</span><span class="token punctuation" data-v-48809fbe>)</span></code></pre></div><p data-v-48809fbe>在 React 里，把 props 传入，返回一个类似 HTML 的结构，然后 render 到指定的 DOM 节点上。这里 React 会算出哪个节点应该被更新：</p> <p data-v-48809fbe><img src="https://gbstatic.djyde.com/blog/react-render-clock.gif" alt="" data-v-48809fbe></p> <p data-v-48809fbe>我们这样手动去 setInterval 然后 render 未免有点傻，我们可以更改 state (也就是通常用到的 <code data-v-48809fbe>setState</code>) 自动地让 React 随着 state 的改变而重新 render. 这里的 time 就是一个 state. 这叫做 Reactive.</p> <p data-v-48809fbe>Functional Programming 里有 Pure Function 的概念。Pure Function 之所以 Pure, 是因为不存在 side effect. 举个例子，我们写一个求和 function：</p> <div class="saber-highlight" data-lang="javascript" data-v-48809fbe><pre class="saber-highlight-code language-javascript" data-v-48809fbe><code class="language-javascript" data-v-48809fbe><span class="token keyword" data-v-48809fbe>function</span> <span class="token function" data-v-48809fbe>add</span> <span class="token punctuation" data-v-48809fbe>(</span><span class="token parameter" data-v-48809fbe>a<span class="token punctuation" data-v-48809fbe>,</span> b</span><span class="token punctuation" data-v-48809fbe>)</span> <span class="token punctuation" data-v-48809fbe>{</span>
  <span class="token keyword" data-v-48809fbe>return</span> a <span class="token operator" data-v-48809fbe>+</span> b
<span class="token punctuation" data-v-48809fbe>}</span></code></pre></div><p data-v-48809fbe>这个求和函数就是一个 pure function. 因为函数内部没有对 input 做任何改变，并且返回一个新的值。我传 1 和 1，得到的永远是 2.</p> <p data-v-48809fbe>Pure Function 的好处是利于维护和测试。要测试一个 Pure Function, 仅仅是传不同的值，预言对应的返回值。</p> <p data-v-48809fbe>现在回头看 React 的 Component, 也可以算是一个 Pure Function——接收不同的 props, 然后 render 对应的 View. 上面 Clock 的例子，props 和返回的 View 是映射关系。</p> <p data-v-48809fbe>光是 <code data-v-48809fbe>state =&gt; View</code> 还不够，在构建 UI 的时候，我们希望 state 改变的时候，立即 rerender 整个 View, 也就是我们经常用到的 <code data-v-48809fbe>setState()</code>.</p> <p data-v-48809fbe>这样就很容易理解为什么我说 React 仅仅是实现构建 UI 思想的手段，因为构建 UI 的思想总结起来就是：</p> <ol data-v-48809fbe><li data-v-48809fbe>State 是 Reactive 的 (比如 React 的 <code data-v-48809fbe>setState</code>)</li> <li data-v-48809fbe>state =&gt; View (依靠 DOM diff)</li> <li data-v-48809fbe>View 组成 Component</li> <li data-v-48809fbe>管理 state （依靠第三方的 state manager）</li></ol> <p data-v-48809fbe>无论是 React 还是 Vue, 大抵都是这样的思想。Vue 1 还不完全是，Vue 2 就更接近了，只是后者写法既可以写得像 template, 又可以写直接写 vdom.</p> <p data-v-48809fbe>而开发者常常感到困难的地方实际上是上面的第 4 点——管理 state. <strong data-v-48809fbe>写 React 写得痛苦，大部分原因是用把 library 当成 framework 去用</strong>，把处理 state 的逻辑瞎写到 View 层中去，也就是所谓的 Dump Component.</p> <p data-v-48809fbe>改变 state 是 side effect, 我们应该把它从 View 层中分离出去。我多次提到，<strong data-v-48809fbe>View 层真正要做的，仅仅是根据 state 返回对应的 View</strong>. state 的变化逻辑，应该在给 state manager 库去做，例如 Redux, Mobx. 下面我用 Mobx 作为例子：</p> <p data-v-48809fbe><img src="https://gbstatic.djyde.com/blog/mobx-ticker.gif" alt="" data-v-48809fbe></p> <p data-v-48809fbe><em data-v-48809fbe><a rel="noopener noreferrer" target="_blank" href="https://jsbin.com/fumerup/edit?js,output" data-v-48809fbe>https://jsbin.com/fumerup/edit?js,output</a></em></p> <p data-v-48809fbe>如果没有接触过 Mobx 不用慌张，只需要知道，Mobx 的 Observable 变化时，被 observer 包装的 React 组件会重新渲染。使用 state manager, 明显地分离了 View 和 side-effect:</p> <p data-v-48809fbe><img src="https://gbstatic.djyde.com/blog/state-effect-view.png" alt="" data-v-48809fbe></p> <p data-v-48809fbe>测试这样的程序，首先为 side effect 的逻辑做测试，再为 View 做测试。View 的测试在这里就十分简单了，给他传一个 store 实例，借助 <a rel="noopener noreferrer" target="_blank" href="https://github.com/airbnb/enzyme" data-v-48809fbe>enzyme</a> 之类的 testing utilities 预言不同的 action 得到的返回 View.</p> <p data-v-48809fbe>React 是 Reactive Programming 在 Web User Interface 上实现的手段，它只不过是一个库，提供了reactive render, component system 和降低开销的 DOM diff 算法. 把 React 换掉，只要不是手动操作 DOM, 其它的框架也不过大同小异。重要的是理解它背后的思想。说到底，前端开发在解决什么问题，用什么样的方式解决问题，在使用任何框架和库之前先把这两个问题思考明白，就不会认为前端难学了。</p></div> <div class="post-footer" data-v-48809fbe><hr data-v-48809fbe> <p data-v-48809fbe>讨论请发邮件到 randypriv@gmail.com</p> <p data-v-48809fbe>未经授权，禁止转载</p> <p data-v-48809fbe>通过支付宝 djyde520@gmail.com 或赞赏码赞助此文</p> <p data-v-48809fbe>
        或通过订阅我的
        <a href="/blog/my-zsxq/" data-v-48809fbe data-v-48809fbe>知识星球</a>支持本博客
      </p> <br data-v-48809fbe> <p data-v-48809fbe><img src="//gbstatic.djyde.com/assets/006tKfTcgy1fkuufy2cadj30w00w0tb2.jpg" class="bmc" data-v-48809fbe></p></div></div></div> <div id="footer"><p><img width="256px" src="//s2.ax1x.com/2019/04/04/A2V9YT.png"></p> <p>
      2014-2019
      <a href="/" class="router-link-active">Randy's Blog</a></p></div></div></div><script src="/_saber/js/client.29710ed1.js" defer></script><script src="/_saber/js/page--_posts-react-and-the-way-building-web-ui-md.52d591a5.js" defer></script></body></html>
